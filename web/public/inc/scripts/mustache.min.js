/*
Author: Darren Schnare
Keywords: javascript,mustache,template
License: MIT ( http://www.opensource.org/licenses/mit-license.php )
Repo: https://github.com/dschnare/mustachejs
*/
var MUSTACHE=function(){"use strict";var t=null,i=function(){return{isArray:function(){var n={}.constructor.prototype.toString;return function(t){return n.call(t)==="[object Array]"}}(),htmlEscape:function(){var n={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&apos;"};return function(t){var i=t.length,u=null,r=null;while(i)i-=1,u=t.charAt(i),r=n[u],r&&(t=t.substring(0,i)+r+t.substring(i+1));return t}}(),trim:function(n){var t=0,i=n.charAt(t);while(i){if(i>" "){n=n.substring(t);break}t+=1,i=n.charAt(t)}t=n.length;while(t){t-=1,i=n.charAt(t);if(i>" "){n=n.substring(0,t+1);break}}return n},indent:function(n,t){var i=n.length,r=null;while(i)i-=1,r=n.charAt(i),(r==="\n"||r==="\r")&&n.charAt(i+1)!=="\n"&&n.charAt(i+1)&&(n=n.substring(0,i+1)+t+n.substring(i+1));return n?t+n:n}}}(),r=function(n){var i={"!":"comment","=":"set-delimiter","":"interpolation","&":"unescape-interpolation","~":"unescape-interpolation","{":"unescape-interpolation","#":"section-begin","^":"invert-section-begin","/":"section-end",">":"partial","@":"partial",".":"implicit"},t=function(r){var s=typeof r.pointer=="function"?function(n){return r.pointer(n)}:function(n){return{value:n,toString:function(){return this.value.toString()},valueOf:function(){return this.value}}},u=s(-1),f=null,e=1,o=function(n){return n!==0&&(u.value+=n||1,f=r.charAt(+u)),f},h=function(n){return r.substr(+u,n)};return{position:function(n){return n=+n,isFinite(n)&&(u.value=n),+u},getTokens:function(n){var f=u.value,r=e,t,i=[];e=1,u.value=0,t=this.next(n);while(t)i.push(t),t=this.next(n);return e=r,u.value=f,i},next:function(c){c||(c=t.defaultDelimiter());var l="",v="",a=-1,y=null,b=null,k=c.left,p=k.length,w=c.right,g=w.length,d=function(){a=-1,v="",l="",y=""};u>0&&(u.value-=1);while(o()){f==="\n"?r.charAt(u-1)!=="\r"&&(e+=1):f==="\r"&&(e+=1);if(h(p)===k){a=+u,o(p);switch(f){case"=":case"!":case"&":case"~":case"{":case"#":case"^":case"/":case">":case"@":v=f;break;case".":v=l=f;break;default:l+=f}while(o())if(!(v==="{"&&w==="}}"&&h(3)==="}}}"))if(h(g)===w){o(g);break}else l+=f;v==="="&&(l=l.substring(0,l.length-1));if(v==="."&&l!==v){d();continue}y=i[v];if(!y){d();continue}b={type:y,value:n.trim(l),text:r.substring(a,+u),start:s(a),end:s(+u),line:e};break}else{a=+u;while(f&&h(p)!==k)o();b={type:"text",value:r.substring(a,u),text:r.substring(a,u),start:s(a),end:s(+u),line:e};break}}return b}}};return t.defaultDelimiter=function(){return{left:"{{",right:"}}"}},t}(i),f=function(){return function(n){n+="";var t=[],i=function(n){return{value:+n,toString:function(){return this.value.toString()},valueOf:function(){return this.value}}};return t.update=function(n,t,i){var u=this.length,e=t-n,r=null,f=function(n){return n>=t};i-=e;while(u)u-=1,r=this[u],f(r)&&(r.value+=i)},{length:n.length,charAt:function(t){return n.charAt(+t)},substr:function(t,i){return n.substr(+t,i)},substring:function(t,i){return n.substring(+t,+i)},replace:function(i){var r=i.substr?n.indexOf(i.substr):+i.begin,f=i.substr?r+i.substr.length:+i.end,u=i.repl===undefined?"":i.repl.toString();n=n.substring(0,r)+u+n.substring(f),t.update(r,f,u.length),this.length=n.length},pointer:function(n){var r=i(n);return t.push(r),r},clearPointers:function(){while(t.length)t.pop()},invalidatePointers:function(){while(t.length)t.pop().value=-1},indexOf:function(r,u){var f=i(n.indexOf(r,+u));return f<0||t.push(f),f},lastIndexOf:function(r,u){var f=i(n.lastIndexOf(r,+u));return f<0||t.push(f),f},toString:function(){return n},valueOf:function(){return n}}}}(),e=function(){return function(n){var t=[{}],r=function(n,t){return function(){return n.apply(t,arguments)}},i={context:function(){return t[t.length-1]},get:function(n){var f=t.length,e,i,u;while(f){f-=1,e=t[f],i=e[n];if(i!==undefined)if(typeof i=="function"){u=r(i,e);break}else{u=i;break}}return u},getContext:function(n){var r=t.length,i;while(r){r-=1,i=t[r];if(i[n]!==undefined)return i}},push:function(n){return t.push(n),n},pop:function(){return t.length!==1&&t.pop(),this.context()}};return arguments.length===1&&i.push(n),i}}(),o=function(n){return function(t){var r=n(t),i=function(){var n=[];return{isOpen:function(){return n.length!==0},open:function(t){n.push(t)},close:function(t){var i=n[n.length-1];if(this.isOpen()&&i.value===t.value)i.endToken=t,n.pop();else throw new Error('Missing section-begin for : "'+t.text+'" on line '+t.line);},current:function(){return n[n.length-1]}}}();return{hasOpenSection:function(){return i.isOpen()},getOpenedSectionToken:function(){return i.current()},next:function(n){var t=r.next(n),f,o,e,u;if(t)switch(t.type){case"set-delimiter":if(t.value&&t.value.indexOf("=")<0){f=t.value.split(" "),o=f[0],e=f[1];if(o.indexOf(" ")>=0||e.indexOf(" ")>=0)throw new Error('Unexpected whitespace in set-delimiter token : "'+t.text+'" on line '+t.line);t.left=o,t.right=e}else throw new Error('Invalid set-delimiter token : "'+t.text+'" on line '+t.line);break;case"section-begin":case"invert-section-begin":i.open(t),u=r.next(n);while(u){switch(u.type){case"section-begin":case"invert-section-begin":i.open(u);break;case"section-end":i.close(u)}if(t.endToken)break;u=r.next(n)}break;case"section-end":i.close(t)}return t}}}}(r),u=function(n,t,i,r,u){var o,s={interpolation:function(n){for(var r=n.name,s=n.contextStack,l=n.partials,h=r.split("."),f=0,t,i,c=h.length,e=s,f=0;f<c-1;f+=1){r=h[f],i=e.getContext(r);if(i===undefined){t="";break}else t=i[r],typeof t=="function"&&(t=t.call(i)),e=u(t)}return r=h[c-1],i=e.getContext(r),i===undefined?t="":(t=i[r],typeof t=="function"&&(t=o.interpret({template:t.call(i),data:s.context(),contextStack:s,partials:l}))),t},section:function(n){for(var r=n.name,e=n.sectionText,h=n.contextStack,v=n.delim,a=n.partials,s=r.split("."),f=0,t,i,l=s.length,c=h,e=e.toString(),f=0;f<l-1;f+=1){r=s[f],i=c.getContext(r);if(i===undefined){t="";break}else t=i[r],typeof t=="function"&&(t=t.length===1?t.call(i,e):t.call(i)),c=u(t)}return r=s[l-1],i=c.getContext(r),i===undefined?t="":(t=i[r],typeof t=="function"&&(t=o.interpret({template:t.call(i,e),data:h.context(),contextStack:h,partials:a,delim:v}))),t},inverseSection:function(n){for(var r=n.name,o=n.sectionText,c=n.contextStack,s=r.split("."),f=0,t,i,h=s.length,e=c,o=o.toString(),f=0;f<h-1;f+=1){r=s[f],i=e.getContext(r);if(i===undefined){t="";break}else t=i[r],typeof t=="function"&&(t=t.length===1?t.call(i,o):t.call(i)),e=u(t)}return r=s[h-1],i=e.getContext(r),i===undefined?t="":(t=i[r],typeof t=="function"&&(t=!0)),t}},f={trimStandaloneToken:function(n,t){var r=t.start-1,i=n.charAt(r),u=!0,f=0,e="";while(i){if(i>" "){u=!1;break}else if(i==="\n"||i==="\r")break;r-=1,i=n.charAt(r)}f=r+1;if(u){r=n.pointer(t.end),i=n.charAt(r);while(i){if(i>" "){u=!1;break}else if(i==="\n"||i==="\r"){i==="\r"&&n.charAt(r+1)==="\n"&&(r.value+=1);break}r.value+=1,i=n.charAt(r)}u&&(e=n.substring(f,t.start),n.replace({begin:f,end:t.start}),n.replace({begin:t.end,end:r+1}))}return e},replaceToken:function(n,t,i){n.replace({begin:t.start.value,end:t.end.value,repl:i||""})},replaceStandaloneToken:function(n,t,i){f.trimStandaloneToken(n,t),n.replace({begin:t.start.value,end:t.end.value,repl:i||""})},renderSection:function(t){var h=t.template,i=t.data,c=t.delim,f=t.contextStack,l=t.partials,r=0,s=0,e="",u=null;for(n.isArray(i)||(i=i?[i]:[]),s=i.length,r=0;r<s;r+=1)f.push(i[r]),u=o.interpret({template:"="+h+"=",data:i[r],contextStack:f,partials:l,delim:c}),e+=u.substring(1,u.length-1),f.pop();return e}},e={implicit:function(n){var u=n.template,e=n.token,t=n.data,i=n.contextStack,r=n.partials;typeof t=="function"&&(t=o.interpret({template:t(),data:i.context(),contextStack:i,partials:r})),f.replaceToken(u,e,t)},setDelimiter:function(n){var r=n.template,t=n.token,i=n.delim;i.left=t.left,i.right=t.right,f.replaceStandaloneToken(r,t)},interpolation:function(t){var u=t.template,r=t.token,e=t.contextStack,o=t.partials,i=s.interpolation({name:r.value,contextStack:e,partials:o});i?(i=n.htmlEscape(i.toString()),f.replaceToken(u,r,i)):f.replaceToken(u,r)},unescapedInterpolation:function(n){var r=n.template,i=n.token,u=n.contextStack,e=n.partials,t=s.interpolation({name:i.value,contextStack:u,partials:e});t?(t+="",f.replaceToken(r,i,t)):f.replaceToken(r,i)},partial:function(t){var h=t.template,r=t.token,l=t.data,c=t.contextStack,s=t.partials,u="",e=f.trimStandaloneToken(h,r),i=s[r.value];i&&(e&&(i=n.indent(i,e)),u=o.interpret({template:i,data:l,contextStack:c,partials:s})),f.replaceToken(h,r,u)},section:function(t){var e=t.template,i=t.token,c=t.contextStack,h=t.partials,l=t.delim,u=i.endToken,o=null,r=null;f.trimStandaloneToken(e,u),f.trimStandaloneToken(e,i),o=e.substring(i.start+i.text.length,u.end-u.text.length),r=s.section({name:i.value,sectionText:o,contextStack:c,delim:l,partials:h}),typeof r=="string"?e.replace({begin:i.start,end:u.end,repl:r}):r&&(!n.isArray(r)||r.length)?e.replace({begin:i.start,end:u.end,repl:f.renderSection({template:o,data:r,contextStack:c,partials:h,delim:l})}):e.replace({begin:i.start,end:u.end})},inverseSection:function(t){var e=t.template,r=t.token,h=t.contextStack,c=t.partials,l=t.delim,u=r.endToken,o=null,i=null;f.trimStandaloneToken(e,u),f.trimStandaloneToken(e,r),o=e.substring(r.start+r.text.length,u.end-u.text.length),i=s.inverseSection({name:r.value,sectionText:o,contextStack:h}),i=i&&(!n.isArray(i)||i.length)?!1:!0,i&&(!n.isArray(i)||i.length)?e.replace({begin:r.start,end:u.end,repl:f.renderSection({template:o,data:i,contextStack:h,partials:c,delim:l})}):e.replace({begin:r.start,end:u.end})}},h=function(){return{interpret:function(n,t,i){return o.interpret({template:n,data:t,partials:i})}}};return o={interpret:function(n){var h=t(n.template?n.template.toString():""),y=n.partials||{},v=n.data||{},c=r(h),a=n.delim||i.defaultDelimiter(),l=n.contextStack||u(),o=null,s={template:h,data:v,contextStack:l,partials:y,delim:a};l.push(v),o=c.next(a);while(o){s.token=o;switch(o.type){case"implicit":e.implicit(s);break;case"comment":f.replaceStandaloneToken(h,o);break;case"set-delimiter":e.setDelimiter(s);break;case"interpolation":e.interpolation(s);break;case"unescape-interpolation":e.unescapedInterpolation(s);break;case"partial":e.partial(s);break;case"section-begin":e.section(s);break;case"invert-section-begin":e.inverseSection(s);break;case"text":break;default:throw new Error('Unexpected token: "'+o.text+'" on line '+o.line);}o=c.next(a)}if(c.hasOpenSection()){o=c.getOpenedSectionToken();throw new Error('Missing section-end for : "'+o.text+'" on line '+o.line);}return l.pop(),h.toString()}},h}(i,f,r,o,e),n={render:function(n,t,i){var r=u();return r.interpret(n,t,i)}};if(typeof define=="function"&&typeof define.amd=="object"&&define.amd)define(n),n=undefined;else if(typeof exports=="object"&&exports&&typeof require=="function"){for(t in n)n.hasOwnProperty(t)&&(exports[t]=n[t]);n=undefined}return n}()