/*
Author: Darren Schnare
Keywords: javascript,mustache,template
License: MIT ( http://www.opensource.org/licenses/mit-license.php )
Repo: https://github.com/dschnare/mustachejs
*/
var MUSTACHE=function(){"use strict";var t=null,i=function(){return{isArray:function(){var n={}.constructor.prototype.toString;return function(t){return n.call(t)==="[object Array]"}}(),htmlEscape:function(){var n={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&apos;"};return function(t){var i=t.length,u=null,r=null;while(i)i-=1,u=t.charAt(i),r=n[u],r&&(t=t.substring(0,i)+r+t.substring(i+1));return t}}(),trim:function(n){var t=0,i=n.charAt(t);while(i){if(i>" "){n=n.substring(t);break}t+=1,i=n.charAt(t)}t=n.length;while(t){t-=1,i=n.charAt(t);if(i>" "){n=n.substring(0,t+1);break}}return n},indent:function(n,t){var i=n.length,r=null;while(i)i-=1,r=n.charAt(i),(r==="\n"||r==="\r")&&n.charAt(i+1)!=="\n"&&n.charAt(i+1)&&(n=n.substring(0,i+1)+t+n.substring(i+1));return n?t+n:n}}}(),r=function(n){var i={"!":"comment","=":"set-delimiter","":"interpolation","&":"unescape-interpolation","~":"unescape-interpolation","{":"unescape-interpolation","#":"section-begin","^":"invert-section-begin","/":"section-end",">":"partial","@":"partial",".":"implicit"},t=function(r){var s=typeof r.pointer=="function"?function(n){return r.pointer(n)}:function(n){return{value:n,toString:function(){return this.value.toString()},valueOf:function(){return this.value}}},u=s(-1),f=null,e=1,o=function(n){return n!==0&&(u.value+=n||1,f=r.charAt(+u)),f},h=function(n){return r.substr(+u,n)};return{position:function(n){return n=+n,isFinite(n)&&(u.value=n),+u},getTokens:function(n){var f=u.value,r=e,t,i=[];e=1,u.value=0,t=this.next(n);while(t)i.push(t),t=this.next(n);return e=r,u.value=f,i},next:function(c){c||(c=t.defaultDelimiter());var l="",v="",a=-1,p=null,y=null,k=c.left,b=k.length,w=c.right,g=w.length,d=function(){a=-1,v="",l="",p=""};u>0&&(u.value-=1);while(o()){f==="\n"?r.charAt(u-1)!=="\r"&&(e+=1):f==="\r"&&(e+=1);if(h(b)===k){a=+u,o(b);switch(f){case"=":case"!":case"&":case"~":case"{":case"#":case"^":case"/":case">":case"@":v=f;break;case".":v=l=f;break;default:l+=f}while(o())if(!(v==="{"&&w==="}}"&&h(3)==="}}}"))if(h(g)===w){o(g);break}else l+=f;v==="="&&(l=l.substring(0,l.length-1));if(v==="."&&l!==v){d();continue}p=i[v];if(!p){d();continue}y={type:p,value:n.trim(l),text:r.substring(a,+u),start:s(a),end:s(+u),line:e};break}else{a=+u;while(f&&h(b)!==k)o();y={type:"text",value:r.substring(a,u),text:r.substring(a,u),start:s(a),end:s(+u),line:e};if(y.text)break;else y=null}}return y}}};return t.defaultDelimiter=function(){return{left:"{{",right:"}}"}},t}(i),f=function(){return function(n){n+="";var t=[],i=function(n){return{value:+n,toString:function(){return this.value.toString()},valueOf:function(){return this.value}}};return t.update=function(n,t,i){var u=this.length,e=t-n,r=null,f=function(n){return n>=t};i-=e;while(u)u-=1,r=this[u],f(r)&&(r.value+=i)},{length:n.length,charAt:function(t){return n.charAt(+t)},substr:function(t,i){return n.substr(+t,i)},substring:function(t,i){return n.substring(+t,+i)},replace:function(i){var r=i.substr?n.indexOf(i.substr):+i.begin,f=i.substr?r+i.substr.length:+i.end,u=i.repl===undefined?"":i.repl.toString();n=n.substring(0,r)+u+n.substring(f),t.update(r,f,u.length),this.length=n.length},pointer:function(n){var r=i(n);return t.push(r),r},clearPointers:function(){while(t.length)t.pop()},invalidatePointers:function(){while(t.length)t.pop().value=-1},indexOf:function(r,u){var f=i(n.indexOf(r,+u));return f<0||t.push(f),f},lastIndexOf:function(r,u){var f=i(n.lastIndexOf(r,+u));return f<0||t.push(f),f},toString:function(){return n},valueOf:function(){return n}}}}(),e=function(){return function(n){var t=[{}],r=function(n,t){var i=function(){return arguments.length?n.apply(t,arguments):n.call(t)};return i.valueOf=n.valueOf===i.valueOf?i.valueOf:function(){return n.valueOf()},i.toString=n.toString===i.toString?i.toString:function(){return n.toString()},i.originalMethod=n,i.thisObj=t,i},i={context:function(){return t[t.length-1]},stack:function(){return t},get:function(n){var f=t.length,e,i,u;while(f){f-=1,e=t[f],i=e[n];if(i!==undefined)if(typeof i=="function"){u=r(i,e);break}else{u=i;break}}return u},push:function(n){return t.push(n),n},pop:function(){return t.length!==1&&t.pop(),this.context()}};return arguments.length===1&&i.push(n),i}}(),o=function(n){return function(t){var r=n(t),i=function(){var n=[];return{isOpen:function(){return n.length!==0},open:function(t){n.push(t)},close:function(t){var i=n[n.length-1];if(this.isOpen()&&i.value===t.value)i.endToken=t,n.pop();else throw new Error('Missing section-begin for : "'+t.text+'" on line '+t.line);},current:function(){return n[n.length-1]}}}();return{hasOpenSection:function(){return i.isOpen()},getOpenedSectionToken:function(){return i.current()},next:function(n){var t=r.next(n),f,o,e,u;if(t)switch(t.type){case"set-delimiter":if(t.value&&t.value.indexOf("=")<0){f=t.value.split(" "),o=f[0],e=f[1];if(o.indexOf(" ")>=0||e.indexOf(" ")>=0)throw new Error('Unexpected whitespace in set-delimiter token : "'+t.text+'" on line '+t.line);t.left=o,t.right=e}else throw new Error('Invalid set-delimiter token : "'+t.text+'" on line '+t.line);break;case"section-begin":case"invert-section-begin":i.open(t),u=r.next(n);while(u){switch(u.type){case"section-begin":case"invert-section-begin":i.open(u);break;case"section-end":i.close(u)}if(t.endToken)break;u=r.next(n)}break;case"section-end":i.close(t)}return t}}}}(r),u=function(n,t,i,r,u){var e,s={}.valueOf,h={interpolation:function(n){for(var r=n.name,h=n.contextStack,c=n.partials,o=r.split("."),i=0,t,e=o.length,f=h,i=0;i<e-1;i+=1)r=o[i],t=f.get(r),t===undefined?(t="",i=e):(t&&typeof t.valueOf=="function"&&t.valueOf!==s?t=t.valueOf():typeof t=="function"&&(t=t()),f=u(t));return r=o[e-1],t=f.get(r),t===undefined?t="":t&&typeof t.valueOf=="function"&&t.valueOf!==s?t=t.valueOf():typeof t=="function"&&(t=t()),t},section:function(n){for(var r=n.name,f=n.sectionText,c=n.contextStack,y=n.delim,p=n.partials,v=c.context(),h=r.split("."),i=0,t,l=h.length,o=c,a=function(n,t){return e.interpret({template:n,data:t||v,delim:y,partials:p,contextStack:c})},f=f.toString(),i=0;i<l-1;i+=1)r=h[i],t=o.get(r),t===undefined?(t="",i=l):(t&&typeof t.valueOf=="function"&&t.valueOf!==s?t=t.valueOf():typeof t=="function"&&(t=t.originalMethod.length<1?t():t(f,a)),o=u(t));return r=h[l-1],t=o.get(r),t===undefined?t="":t&&typeof t.valueOf=="function"&&t.valueOf!==s?t=t.valueOf():typeof t=="function"&&(t=t(f,a)),t},inverseSection:function(n){for(var i=n.name,h=n.sectionText,c=n.contextStack,v=n.delim,y=n.partials,p=c.context(),o=i.split("."),r=0,t,f=o.length,l=c,a=function(n,t){return e.interpret({template:n,data:t||p,delim:v,partials:y,contextStack:c})},h=h.toString(),r=0;r<f-1;r+=1)i=o[r],t=l.get(i),t===undefined?(t="",r=f):(t&&typeof t.valueOf=="function"&&t.valueOf!==s?t=t.valueOf():typeof t=="function"&&(t=t.originalMethod.length<1?t():t(h,a)),l=u(t));return i=o[f-1],t=l.get(i),t===undefined?t="":typeof t=="function"&&(t=!0),t}},f={trimStandaloneToken:function(n,t){var r=t.start-1,i=n.charAt(r),u=!0,f=0,e="";while(i){if(i>" "){u=!1;break}else if(i==="\n"||i==="\r")break;r-=1,i=n.charAt(r)}f=r+1;if(u){r=n.pointer(t.end),i=n.charAt(r);while(i){if(i>" "){u=!1;break}else if(i==="\n"||i==="\r"){i==="\r"&&n.charAt(r+1)==="\n"&&(r.value+=1);break}r.value+=1,i=n.charAt(r)}u&&(e=n.substring(f,t.start),n.replace({begin:f,end:t.start}),n.replace({begin:t.end,end:r+1}))}return e},replaceToken:function(n,t,i){n.replace({begin:t.start.value,end:t.end.value,repl:i||""})},replaceStandaloneToken:function(n,t,i){f.trimStandaloneToken(n,t),n.replace({begin:t.start.value,end:t.end.value,repl:i||""})},renderSection:function(t){var v=t.template,r=t.data,y=t.delim,u=t.contextStack,a=t.partials,f=0,l=0,c="",h=null,i,o=!1;for(n.isArray(r)||(r=r?[r]:[]),l=r.length,f=0;f<l;f+=1)i=r[f],o=!1,u.push(i),i&&typeof i.valueOf=="function"&&i.valueOf!==s&&(o=!0,i=i.valueOf(),u.push(i)),typeof i=="function"&&(o=!0,i=i(),u.push(i)),h=e.interpret({template:"="+v+"=",data:i,contextStack:u,partials:a,delim:y}),c+=h.substring(1,h.length-1),u.pop(),o&&u.pop();return c}},o={implicit:function(n){var u=n.template,o=n.token,t=n.data,i=n.contextStack,r=n.partials;t=e.interpret({template:typeof t=="function"?t():t,data:i.context(),contextStack:i,partials:r}),f.replaceToken(u,o,t)},setDelimiter:function(n){var r=n.template,t=n.token,i=n.delim;i.left=t.left,i.right=t.right,f.replaceStandaloneToken(r,t)},interpolation:function(t){var o=t.template,r=t.token,u=t.contextStack,s=t.partials,i=h.interpolation({name:r.value,contextStack:u,partials:s});i=e.interpret({template:i,data:u.context(),contextStack:u,partials:s}),i?(i=n.htmlEscape(i.toString()),f.replaceToken(o,r,i)):f.replaceToken(o,r)},unescapedInterpolation:function(n){var u=n.template,i=n.token,r=n.contextStack,o=n.partials,t=h.interpolation({name:i.value,contextStack:r,partials:o});t=e.interpret({template:t,data:r.context(),contextStack:r,partials:o}),t?(t+="",f.replaceToken(u,i,t)):f.replaceToken(u,i)},partial:function(t){var h=t.template,r=t.token,l=t.data,c=t.contextStack,s=t.partials,u="",o=f.trimStandaloneToken(h,r),i=s[r.value];i&&(o&&(i=n.indent(i,o)),u=e.interpret({template:i,data:l,contextStack:c,partials:s})),f.replaceToken(h,r,u)},section:function(t){var o=t.template,r=t.token,s=t.contextStack,c=t.partials,a=t.delim,u=r.endToken,l=null,i=null;f.trimStandaloneToken(o,u),f.trimStandaloneToken(o,r),l=o.substring(r.start+r.text.length,u.end-u.text.length),i=h.section({name:r.value,sectionText:l,contextStack:s,delim:a,partials:c}),typeof i=="string"?(i=e.interpret({template:i,data:s.context(),contextStack:s,delim:a,partials:c}),o.replace({begin:r.start,end:u.end,repl:i})):i&&(!n.isArray(i)||i.length)?o.replace({begin:r.start,end:u.end,repl:f.renderSection({template:l,data:i,contextStack:s,partials:c,delim:a})}):o.replace({begin:r.start,end:u.end})},inverseSection:function(t){var e=t.template,r=t.token,c=t.contextStack,s=t.partials,l=t.delim,u=r.endToken,o=null,i=null;f.trimStandaloneToken(e,u),f.trimStandaloneToken(e,r),o=e.substring(r.start+r.text.length,u.end-u.text.length),i=h.inverseSection({name:r.value,sectionText:o,delim:l,partials:s,contextStack:c}),i=i&&(!n.isArray(i)||i.length)?!1:!0,i&&(!n.isArray(i)||i.length)?e.replace({begin:r.start,end:u.end,repl:f.renderSection({template:o,data:i,contextStack:c,partials:s,delim:l})}):e.replace({begin:r.start,end:u.end})}},c=function(){return{interpret:function(n,t,i){return e.interpret({template:n,data:t,partials:i})}}};return e={interpret:function(n){var h=t(n.template?n.template.toString():""),y=n.partials||{},v=n.data||{},c=r(h),a=n.delim||i.defaultDelimiter(),l=n.contextStack||u(),e=null,s={template:h,data:v,contextStack:l,partials:y,delim:a};l.push(v),e=c.next(a);while(e){s.token=e;switch(e.type){case"implicit":o.implicit(s);break;case"comment":f.replaceStandaloneToken(h,e);break;case"set-delimiter":o.setDelimiter(s);break;case"interpolation":o.interpolation(s);break;case"unescape-interpolation":o.unescapedInterpolation(s);break;case"partial":o.partial(s);break;case"section-begin":o.section(s);break;case"invert-section-begin":o.inverseSection(s);break;case"text":break;default:throw new Error('Unexpected token: "'+e.text+'" on line '+e.line);}e=c.next(a)}if(c.hasOpenSection()){e=c.getOpenedSectionToken();throw new Error('Missing section-end for : "'+e.text+'" on line '+e.line);}return l.pop(),h.toString()}},c}(i,f,r,o,e),n={render:function(n,t,i){var r=u();return r.interpret(n,t,i)}};if(typeof define=="function"&&typeof define.amd=="object"&&define.amd)define(n),n=undefined;else if(typeof exports=="object"&&exports&&typeof require=="function"){for(t in n)n.hasOwnProperty(t)&&(exports[t]=n[t]);n=undefined}return n}()