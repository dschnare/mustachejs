/*
Author: Darren Schnare
Keywords: javascript,mustache,template
License: MIT ( http://www.opensource.org/licenses/mit-license.php )
Repo: https://github.com/dschnare/mustachejs
*/
var MUSTACHE=function(){"use strict";var t=null,i=function(){return{isArray:function(){var n={}.constructor.prototype.toString;return function(t){return n.call(t)==="[object Array]"}}(),htmlEscape:function(){var n={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&apos;"};return function(t){var i=t.length,u=null,r=null;while(i)i-=1,u=t.charAt(i),r=n[u],r&&(t=t.substring(0,i)+r+t.substring(i+1));return t}}(),trim:function(n){var t=0,i=n.charAt(t);while(i){if(i>" "){n=n.substring(t);break}t+=1,i=n.charAt(t)}t=n.length;while(t){t-=1,i=n.charAt(t);if(i>" "){n=n.substring(0,t+1);break}}return n},indent:function(n,t){var i=n.length,r=null;while(i)i-=1,r=n.charAt(i),(r==="\n"||r==="\r")&&n.charAt(i+1)!=="\n"&&n.charAt(i+1)&&(n=n.substring(0,i+1)+t+n.substring(i+1));return n?t+n:n}}}(),f=function(n){var i={"!":"comment","=":"set-delimiter","":"interpolation","&":"unescape-interpolation","{":"unescape-interpolation","#":"section-begin","^":"invert-section-begin","/":"section-end",">":"partial",".":"implicit"},t=function(r){var s=typeof r.pointer=="function"?function(n){return r.pointer(n)}:function(n){return{value:n,toString:function(){return this.value.toString()},valueOf:function(){return this.value}}},f=s(-1),u=null,h=1,e=function(n){return n!==0&&(f.value+=n||1,u=r.charAt(+f)),u},o=function(n){return r.substr(+f,n)};return{defaultDelimiter:function(){return t.defaultDelimiter()},next:function(c){c||(c=t.defaultDelimiter());var l="",a="",y=-1,v=null,k=c.left,d=k.length,w=c.right,p=w.length,b=function(){y=-1,a="",l="",v=""};f>0&&(f.value-=1);while(e()){u==="\n"?r.charAt(f-1)!=="\r"&&(h+=1):u==="\r"&&(h+=1);if(o(d)===k){y=+f,e(d);switch(u){case"=":case"!":case"&":case"~":case"{":case"#":case"^":case"/":case">":case"@":a=u;break;case".":a=l=u;break;default:l+=u}while(e())if(!(a==="{"&&w==="}}"&&o(p+1)==="}}}"))if(o(p)===w){e(p);break}else l+=u;a==="="&&(l=l.substring(0,l.length-1));if(a==="."&&l!==a){b();continue}v=i[a];if(!v){b();continue}return{type:v,value:n.trim(l),text:r.substring(y,+f),start:s(y),end:s(+f),line:h}}}return null}}};return t.defaultDelimiter=function(){return{left:"{{",right:"}}"}},t}(i),u=function(){return function(n){n+="";var t=[],i=function(n){return{value:+n,toString:function(){return this.value.toString()},valueOf:function(){return this.value}}};return t.update=function(n,t,i){var u=this.length,e=t-n,r=null,f=function(n){return n>=t};i-=e;while(u)u-=1,r=this[u],f(r)&&(r.value+=i)},{length:n.length,charAt:function(t){return n.charAt(+t)},substr:function(t,i){return n.substr(+t,i)},substring:function(t,i){return n.substring(+t,+i)},replace:function(i){var r=i.substr?n.indexOf(i.substr):+i.begin,f=i.substr?r+i.substr.length:+i.end,u=i.repl===undefined?"":i.repl.toString();n=n.substring(0,r)+u+n.substring(f),t.update(r,f,u.length),this.length=n.length},pointer:function(n){var r=i(n);return t.push(r),r},clearPointers:function(){while(t.length)t.pop()},invalidatePointers:function(){while(t.length)t.pop().value=-1},indexOf:function(r,u){var f=i(n.indexOf(r,+u));return f<0||t.push(f),f},lastIndexOf:function(r,u){var f=i(n.lastIndexOf(r,+u));return f<0||t.push(f),f},toString:function(){return n},valueOf:function(){return n}}}}(),e=function(){return function(n){var t=[{}],r=function(n,t){return function(){return n.apply(t,arguments)}},i={context:function(){return t[t.length-1]},get:function(n){var f=t.length,e,i,u;while(f){f-=1,e=t[f],i=e[n];if(i!==undefined)if(typeof i=="function"){u=r(i,e);break}else{u=i;break}}return u},getContext:function(n){var r=t.length,i;while(r){r-=1,i=t[r];if(i[n]!==undefined)return i}},push:function(n){return t.push(n),n},pop:function(){return t.length!==1&&t.pop(),this.context()}};return arguments.length===1&&i.push(n),i}}(),r=function(n,t,i,r){var s=function(n,t,i,u,f,e){var l=n.split("."),h=0,o,s,a=l.length,c=i;for(t=t.toString(),h=0;h<a-1;h+=1){n=l[h],s=c.getContext(n);if(s===undefined){o="";break}else o=s[n],typeof o=="function"&&(o=o.length===1?o.call(s,t):o.call(s)),c=r(o)}return n=l[a-1],s=c.getContext(n),s===undefined?o="":(o=s[n],typeof o=="function"&&(o=e.parse({template:o.call(s,t),data:i.context(),contextStack:i,partials:f,delim:u}))),o},h=function(n,t,i){var s=n.split("."),e=0,u,f,h=s.length,o=i;for(t=t.toString(),e=0;e<h-1;e+=1){n=s[e],f=o.getContext(n);if(f===undefined){u="";break}else u=f[n],typeof u=="function"&&(u=u.length===1?u.call(f,t):u.call(f)),o=r(u)}return n=s[h-1],f=o.getContext(n),f===undefined?u="":(u=f[n],typeof u=="function"&&(u=!0)),u},e=function(n,t,i,u){for(var h=n.split("."),o=0,f,e,c=h.length,s=t,o=0;o<c-1;o+=1){n=h[o],e=s.getContext(n);if(e===undefined){f="";break}else f=e[n],typeof f=="function"&&(f=f.call(e)),s=r(f)}return n=h[c-1],e=s.getContext(n),e===undefined?f="":(f=e[n],typeof f=="function"&&(f=u.parse({template:f.call(e),data:t.context(),contextStack:t,partials:i}))),f},f=function(t){var l=t.template,i=t.data,h=t.delim,f=t.contextStack,s=t.partials,c=t.parser,r=0,e=0,o="",u=null;for(n.isArray(i)||(i=i?[i]:[]),e=i.length,r=0;r<e;r+=1)f.push(i[r]),u=c.parse({template:"="+l+"=",data:i[r],contextStack:f,partials:s,delim:h}),o+=u.substring(1,u.length-1),f.pop();return o},u=function(n,t){var r=n.start-1,i=t.charAt(r),u=!0,f=0,e="";while(i){if(i>" "){u=!1;break}else if(i==="\n"||i==="\r")break;r-=1,i=t.charAt(r)}f=r+1;if(u){r=t.pointer(n.end),i=t.charAt(r);while(i){if(i>" "){u=!1;break}else if(i==="\n"||i==="\r"){i==="\r"&&t.charAt(r+1)==="\n"&&(r.value+=1);break}r.value+=1,i=t.charAt(r)}u&&(e=t.substring(f,n.start),t.replace({begin:f,end:n.start}),t.replace({begin:n.end,end:r+1}))}return e},o=function(n,t,i){var r=t.next(i),u=[];while(r){switch(r.type){case"section-end":if(u.length&&r.value===u[u.length-1].value)u.pop();else if(n.value===r.value){if(!u.length)return r;throw new Error('Unbalanced sections encountered: "'+r.text+'" on line '+r.line);}break;case"section-begin":case"invert-section-begin":u.push(r)}r=t.next(i)}throw new Error('Missing end-section for section : "'+n.text+'" on line '+n.line);};return{makeParser:function(){return{parse:function(c){var l=t(c.template?c.template.toString():""),p=c.partials||{},k=c.data||{},d=i(l),y=c.delim||d.defaultDelimiter(),v=c.contextStack||r(),w=this,a=null,b=function(n,t){l.replace({begin:n.start.value,end:n.end.value,repl:t})},g=function(n,t){u(n,l),l.replace({begin:n.start.value,end:n.end.value,repl:t})},rt=function(n){var r,i,t;if(n.value&&n.value.indexOf("=")<0){r=n.value.split(" "),i=r[0],t=r[1];if(i.indexOf(" ")>=0||t.indexOf(" ")>=0)throw new Error('Invalid custom delimiter: "'+n.text+'" on line '+n.line);y.left=i,y.right=t,g(n)}else throw new Error('Invalid custom delimiter: "'+n.text+'" on line '+n.line);},ut=function(t){var i=e(t.value,v,p,w);i?(i=n.htmlEscape(i.toString()),b(t,i)):b(t)},ft=function(n){var t=e(n.value,v,p,w);t?(t+="",b(n,t)):b(n)},nt=function(t){var r="",f=u(t,l),i=p[t.value];i&&(f&&(i=n.indent(i,f)),r=w.parse({template:i,data:k,contextStack:v,partials:p})),b(t,r)},tt=function(t){var r=o(t,d,y),e=null,i=null;if(!r)throw new Error('Unbalanced sections encountered: "'+t.text+'" on line '+t.line);u(r,l),u(t,l),e=l.substring(t.start+t.text.length,r.end-r.text.length),i=s(t.value,e,v,y,p,w),typeof i=="string"?l.replace({begin:t.start,end:r.end,repl:i}):i&&(!n.isArray(i)||i.length)?l.replace({begin:t.start,end:r.end,repl:f({template:e,data:i,contextStack:v,partials:p,parser:w,delim:y})}):l.replace({begin:t.start,end:r.end})},it=function(t){var r=o(t,d,y),e=null,i=null;if(!r)throw new Error('Unbalanced sections encountered: "'+t.text+'" on line '+t.line);u(r,l),u(t,l),e=l.substring(t.start+t.text.length,r.end-r.text.length),i=h(t.value,e,v),i=i&&(!n.isArray(i)||i.length)?!1:!0,i&&(!n.isArray(i)||i.length)?l.replace({begin:t.start,end:r.end,repl:f({template:e,data:i,contextStack:v,partials:p,parser:w,delim:y})}):l.replace({begin:t.start,end:r.end})};v.push(k),a=d.next(y);while(a){switch(a.type){case"implicit":typeof k=="function"&&(k=w.parse({template:k(),data:v.context(),contextStack:v,partials:p})),b(a,k);break;case"comment":g(a);break;case"set-delimiter":rt(a);break;case"interpolation":ut(a);break;case"unescape-interpolation":ft(a);break;case"partial":nt(a);break;case"section-begin":tt(a);break;case"invert-section-begin":it(a);break;default:throw new Error('Unexpected token: "'+a.text+'" on line '+a.line);}a=d.next(y)}return v.pop(),l.toString()}}}}}(i,u,f,e),n={render:function(n,t,i){var u=r.makeParser();return u.parse({template:n,data:t,partials:i})}};if(typeof define=="function"&&typeof define.amd=="object"&&define.amd)define(n),n=undefined;else if(typeof exports=="object"&&exports&&typeof require=="function"){for(t in n)n.hasOwnProperty(t)&&(exports[t]=n[t]);n=undefined}return n}()